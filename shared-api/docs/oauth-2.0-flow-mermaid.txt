sequenceDiagram
    participant C as Client App
    participant S as Server App
    participant O as OAuth Provider

    C->>O: GET https://oauth-provider.com/authorize
    note over C,O: Request: client_id=CLIENT_ID, response_type=code, redirect_uri=https://client-app.com/callback, state=xyz123, scope=openid profile
    O-->>C: HTTP 302 (Redirect) to https://client-app.com/callback
    note over O,C: Response: ?code=AUTH_CODE&state=xyz123

    C->>S: POST https://server-app.com/token
    note over C,S: Request: grant_type=authorization_code, code=AUTH_CODE, redirect_uri=https://client-app.com/callback, client_id=CLIENT_ID, client_secret=CLIENT_SECRET
    S->>O: POST https://oauth-provider.com/token
    note over S,O: Request: grant_type=authorization_code, code=AUTH_CODE, redirect_uri=https://client-app.com/callback, client_id=CLIENT_ID, client_secret=CLIENT_SECRET
    O-->>S: HTTP 200
    note over O,S: Response: {"access_token": "ACCESS_TOKEN", "token_type": "Bearer", "expires_in": 3600, "refresh_token": "REFRESH_TOKEN", "id_token": "ID_TOKEN"}
    S-->>C: HTTP 200
    note over S,C: Response: {"access_token": "ACCESS_TOKEN", "token_type": "Bearer", "expires_in": 3600, "refresh_token": "REFRESH_TOKEN", "id_token": "ID_TOKEN"}

    C->>S: GET https://server-app.com/resource
    note over C,S: Request: Authorization: Bearer ACCESS_TOKEN
    S->>O: GET https://oauth-provider.com/resource
    note over S,O: Request: Authorization: Bearer ACCESS_TOKEN
    O-->>S: HTTP 200
    note over O,S: Response: {"data": "Protected Resource Data"}
    S-->>C: HTTP 200
    note over S,C: Response: {"data": "Protected Resource Data"}
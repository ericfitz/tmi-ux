{
  "id": "550e8400-e29b-41d4-a716-446655440002",
  "name": "Mobile App Threat Model",
  "description": "Security assessment for mobile application",
  "created_at": "2025-01-21T21:58:00.000Z",
  "modified_at": "2025-01-23T21:58:00.000Z",
  "owner": "user@example.com",
  "created_by": "user@example.com",
  "threat_model_framework": "LINDDUN",
  "issue_url": "https://issues.example.com/browse/TM-125",
  "authorization": [
    {
      "subject": "user@example.com",
      "role": "owner"
    },
    {
      "subject": "mobile-dev@example.com",
      "role": "writer"
    },
    {
      "subject": "qa-team@example.com",
      "role": "reader"
    }
  ],
  "metadata": [
    {
      "key": "Platform",
      "value": "iOS, Android"
    },
    {
      "key": "Version",
      "value": "2.0"
    },
    {
      "key": "Development Stage",
      "value": "Beta"
    }
  ],
  "documents": [
    {
      "id": "6ba7b810-9dad-11d1-beef-00c04fd430cb",
      "name": "Mobile Security Guidelines",
      "url": "https://docs.example.com/mobile-security-guidelines.pdf",
      "description": "OWASP mobile security testing guide compliance",
      "metadata": [
        {
          "key": "document_type",
          "value": "guidelines"
        },
        {
          "key": "standard",
          "value": "OWASP MSTG"
        }
      ]
    },
    {
      "id": "7ba7b810-9dad-11d1-beef-00c04fd430cc",
      "name": "Privacy Impact Assessment",
      "url": "https://docs.example.com/privacy-impact-assessment.docx",
      "description": "GDPR and privacy compliance assessment for mobile app",
      "metadata": [
        {
          "key": "document_type",
          "value": "assessment"
        },
        {
          "key": "regulation",
          "value": "GDPR"
        }
      ]
    }
  ],
  "sourceCode": [
    {
      "id": "8ba7b810-1dad-11d1-8080-00c04fd430ca",
      "name": "Mobile App Repository",
      "description": "Flutter mobile application source code",
      "type": "git",
      "url": "https://github.com/example/mobile-app.git",
      "parameters": {
        "refType": "branch",
        "refValue": "development"
      },
      "metadata": [
        {
          "key": "platform",
          "value": "flutter"
        },
        {
          "key": "environment",
          "value": "development"
        }
      ]
    },
    {
      "id": "8ba7b810-1dad-11d1-8080-00c04fd430cb",
      "name": "Mobile Backend API",
      "description": "Node.js backend API for mobile app",
      "type": "git",
      "url": "https://github.com/example/mobile-backend.git",
      "parameters": {
        "refType": "commit",
        "refValue": "a1b2c3d4e5f6",
        "subPath": "api"
      },
      "metadata": [
        {
          "key": "language",
          "value": "nodejs"
        },
        {
          "key": "framework",
          "value": "express"
        }
      ]
    }
  ],
  "diagrams": [
    {
      "id": "323e4567-e89b-12d3-a456-426614174000",
      "name": "Mobile App Components",
      "description": "Mobile application component diagram",
      "created_at": "2025-01-21T21:58:00.000Z",
      "modified_at": "2025-01-23T21:58:00.000Z",
      "type": "DFD-1.0.0",
      "metadata": [
        {
          "key": "platform",
          "value": "mobile"
        },
        {
          "key": "complexity",
          "value": "high"
        }
      ],
      "cells": [
        {
          "id": "mobile-cell-1",
          "shape": "actor",
          "x": 100,
          "y": 200,
          "width": 80,
          "height": 80,
          "zIndex": 1,
          "visible": true,
          "attrs": {
            "body": {
              "fill": "#ffffff",
              "stroke": "#000000",
              "strokeWidth": 2
            },
            "text": {
              "text": "Mobile User",
              "fontSize": 12,
              "fill": "#000000"
            }
          },
          "data": [
            {
              "key": "user_type",
              "value": "mobile_user"
            }
          ]
        },
        {
          "id": "mobile-cell-2",
          "shape": "process",
          "x": 250,
          "y": 200,
          "width": 120,
          "height": 60,
          "zIndex": 1,
          "visible": true,
          "attrs": {
            "body": {
              "fill": "#e8f4fd",
              "stroke": "#1976d2",
              "strokeWidth": 2
            },
            "text": {
              "text": "Mobile App",
              "fontSize": 12,
              "fill": "#0d47a1"
            }
          },
          "data": [
            {
              "key": "app_type",
              "value": "flutter"
            }
          ]
        },
        {
          "id": "mobile-cell-3",
          "shape": "store",
          "x": 250,
          "y": 300,
          "width": 120,
          "height": 60,
          "zIndex": 1,
          "visible": true,
          "attrs": {
            "body": {
              "fill": "#fff3e0",
              "stroke": "#f57c00",
              "strokeWidth": 2
            },
            "text": {
              "text": "Local Storage",
              "fontSize": 12,
              "fill": "#e65100"
            }
          },
          "data": [
            {
              "key": "storage_type",
              "value": "sqlite"
            }
          ]
        },
        {
          "id": "mobile-cell-4",
          "shape": "process",
          "x": 450,
          "y": 200,
          "width": 120,
          "height": 60,
          "zIndex": 1,
          "visible": true,
          "attrs": {
            "body": {
              "fill": "#e0e0ff",
              "stroke": "#4040ff",
              "strokeWidth": 2
            },
            "text": {
              "text": "API Gateway",
              "fontSize": 12,
              "fill": "#2020cc"
            }
          },
          "data": [
            {
              "key": "gateway_type",
              "value": "api_gateway"
            }
          ]
        },
        {
          "id": "mobile-cell-5",
          "shape": "process",
          "x": 650,
          "y": 150,
          "width": 120,
          "height": 60,
          "zIndex": 1,
          "visible": true,
          "attrs": {
            "body": {
              "fill": "#e8f5e8",
              "stroke": "#388e3c",
              "strokeWidth": 2
            },
            "text": {
              "text": "Authentication Service",
              "fontSize": 10,
              "fill": "#1b5e20"
            }
          },
          "data": [
            {
              "key": "auth_type",
              "value": "oauth2"
            }
          ]
        },
        {
          "id": "mobile-cell-6",
          "shape": "process",
          "x": 650,
          "y": 250,
          "width": 120,
          "height": 60,
          "zIndex": 1,
          "visible": true,
          "attrs": {
            "body": {
              "fill": "#f3e5f5",
              "stroke": "#7b1fa2",
              "strokeWidth": 2
            },
            "text": {
              "text": "Business Logic",
              "fontSize": 12,
              "fill": "#4a148c"
            }
          },
          "data": [
            {
              "key": "service_type",
              "value": "business_logic"
            }
          ]
        },
        {
          "id": "mobile-cell-7",
          "shape": "store",
          "x": 850,
          "y": 200,
          "width": 100,
          "height": 60,
          "zIndex": 1,
          "visible": true,
          "attrs": {
            "body": {
              "fill": "#fff0e0",
              "stroke": "#cc6600",
              "strokeWidth": 2
            },
            "text": {
              "text": "Database",
              "fontSize": 12,
              "fill": "#994400"
            }
          },
          "data": [
            {
              "key": "db_type",
              "value": "postgresql"
            }
          ]
        },
        {
          "id": "mobile-cell-8",
          "shape": "security-boundary",
          "x": 200,
          "y": 150,
          "width": 200,
          "height": 250,
          "zIndex": 0,
          "visible": true,
          "attrs": {
            "body": {
              "fill": "transparent",
              "stroke": "#ff9800",
              "strokeWidth": 3,
              "strokeDasharray": "10,5"
            },
            "text": {
              "text": "Mobile Device",
              "fontSize": 14,
              "fill": "#e65100"
            }
          },
          "data": [
            {
              "key": "boundary_type",
              "value": "device"
            }
          ]
        },
        {
          "id": "mobile-cell-9",
          "shape": "security-boundary",
          "x": 600,
          "y": 100,
          "width": 400,
          "height": 250,
          "zIndex": 0,
          "visible": true,
          "attrs": {
            "body": {
              "fill": "transparent",
              "stroke": "#ff0000",
              "strokeWidth": 3,
              "strokeDasharray": "10,5"
            },
            "text": {
              "text": "Server Environment",
              "fontSize": 14,
              "fill": "#cc0000"
            }
          },
          "data": [
            {
              "key": "boundary_type",
              "value": "server"
            }
          ]
        }
      ]
    }
  ],
  "threats": [
    {
      "id": "8ba7b810-9dad-11d1-80b4-00c04fd430c8",
      "threat_model_id": "550e8400-e29b-41d4-a716-446655440002",
      "name": "Insecure Data Storage",
      "description": "Sensitive data stored insecurely on device",
      "created_at": "2025-01-21T21:58:00.000Z",
      "modified_at": "2025-01-23T21:58:00.000Z",
      "diagram_id": "323e4567-e89b-12d3-a456-426614174000",
      "cell_id": "mobile-cell-3",
      "severity": "High",
      "score": 7.2,
      "priority": "High",
      "mitigated": false,
      "status": "Open",
      "threat_type": "Information Disclosure",
      "metadata": [
        {
          "key": "CVSS",
          "value": "7.2"
        },
        {
          "key": "Issue ID",
          "value": "jira-44444"
        }
      ]
    },
    {
      "id": "8ba7b810-9dad-11d1-80b4-00c04fd430c9",
      "threat_model_id": "550e8400-e29b-41d4-a716-446655440002",
      "name": "Insecure Communication",
      "description": "Unencrypted data transmission",
      "created_at": "2025-01-21T21:58:00.000Z",
      "modified_at": "2025-01-23T21:58:00.000Z",
      "diagram_id": "323e4567-e89b-12d3-a456-426614174000",
      "cell_id": "mobile-cell-4",
      "severity": "Medium",
      "score": 6.8,
      "priority": "Medium",
      "mitigated": false,
      "status": "Open",
      "threat_type": "Information Disclosure",
      "metadata": [
        {
          "key": "CVSS",
          "value": "6.8"
        },
        {
          "key": "Issue ID",
          "value": "jira-55555"
        }
      ]
    },
    {
      "id": "8ba7b810-9dad-11d1-80b4-00c04fd430ca",
      "threat_model_id": "550e8400-e29b-41d4-a716-446655440002",
      "name": "Insufficient Authentication",
      "description": "Weak authentication mechanisms",
      "created_at": "2025-01-22T21:58:00.000Z",
      "modified_at": "2025-01-23T21:58:00.000Z",
      "diagram_id": "323e4567-e89b-12d3-a456-426614174000",
      "cell_id": "mobile-cell-5",
      "severity": "High",
      "score": 7.5,
      "priority": "High",
      "mitigated": false,
      "status": "Open",
      "threat_type": "Authentication Bypass",
      "metadata": [
        {
          "key": "CVSS",
          "value": "7.5"
        },
        {
          "key": "Issue ID",
          "value": "jira-66666"
        }
      ]
    },
    {
      "id": "8ba7b810-9dad-11d1-80b4-00c04fd430cb",
      "threat_model_id": "550e8400-e29b-41d4-a716-446655440002",
      "name": "Code Injection",
      "description": "Injection of malicious code through user input",
      "created_at": "2025-01-22T21:58:00.000Z",
      "modified_at": "2025-01-23T21:58:00.000Z",
      "diagram_id": "323e4567-e89b-12d3-a456-426614174000",
      "cell_id": "mobile-cell-2",
      "severity": "Critical",
      "score": 8.7,
      "priority": "Critical",
      "mitigated": false,
      "status": "Open",
      "threat_type": "Elevation of Privilege",
      "metadata": [
        {
          "key": "CVSS",
          "value": "8.7"
        },
        {
          "key": "Issue ID",
          "value": "jira-77777"
        }
      ]
    }
  ]
}